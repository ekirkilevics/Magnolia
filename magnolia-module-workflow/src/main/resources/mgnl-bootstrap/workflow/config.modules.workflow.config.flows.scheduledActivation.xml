<?xml version="1.0" encoding="UTF-8"?>
<sv:node sv:name="scheduledActivation"
  xmlns:jcr="http://www.jcp.org/jcr/1.0"
  xmlns:mgnl="http://www.magnolia.info/jcr/mgnl"
  xmlns:mix="http://www.jcp.org/jcr/mix/1.0" xmlns:rep="internal"
  xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:fn="http://www.w3.org/2004/10/xpath-functions"
  xmlns:sv="http://www.jcp.org/jcr/sv/1.0"
  xmlns:jcrfn="http://www.jcp.org/jcr/xpath-functions/1.0" xmlns="">
  <sv:property sv:name="jcr:primaryType" sv:type="Name">
    <sv:value>mgnl:content</sv:value>
  </sv:property>
  <sv:property sv:name="jcr:mixinTypes" sv:type="Name">
    <sv:value>mix:versionable</sv:value>
  </sv:property>
  <sv:property sv:name="jcr:uuid" sv:type="String">
    <sv:value>3d023653-16be-4763-b030-93bd458d1bc8</sv:value>
  </sv:property>
  <sv:property sv:name="value" sv:type="String">
    <sv:value>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&#xd;
&lt;process-definition xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.openwfe.org/flowdef_r1.5.0.xsd" name="scheduledActivation" revision="1.0"&gt;&#xd;
  &lt;description language="default"&gt;worflow for web activation process.&lt;/description&gt; &#xd;
&lt;sequence&gt;&#xd;
&lt;log message="~~~~~~~~~~~~~~~flow starts, start date is '${f:startDate}', end date is '${f:endDate}'"/&gt;&#xd;
&lt;set field="mailTo" value="user-superuser"/&gt;&#xd;
&lt;set field="mailTemplate" value="testMagnolia"/&gt;&#xd;
&lt;!--&#xd;
&lt;set field="startDate" value=""/&gt;&#xd;
&lt;set field="endDate" value=""/&gt;&#xd;
--&gt;&#xd;
&lt;log message="~~~~~~~~~~~~~~~going to send mail"/&gt;&#xd;
&lt;participant ref="command-sendMail"/&gt;&#xd;
&lt;log message="~~~~~~~~~~~~~~~going to inbox"/&gt;&#xd;
&lt;participant ref="group-publisher"/&gt;&#xd;
&lt;log message="~~~~~~~~~~~~~~~sleep before activation"/&gt;&#xd;
&lt;if&gt;&#xd;
&#xd;
	&lt;defined field-value="startDate"/&gt;&#xd;
	&lt;sleep until="${f:startDate}"/&gt;&#xd;
&lt;/if&gt;&#xd;
&#xd;
&lt;log message="~~~~~~~~~~~~~~~going to activate"/&gt;&#xd;
&#xd;
&lt;!-- activate --&gt;&#xd;
&lt;if&gt;&#xd;
	&lt;equals field-value="action" other-value="proceed"/&gt;&#xd;
	&lt;!-- then --&gt;&#xd;
	&lt;participant ref="command-activate"/&gt;&#xd;
	&lt;!-- else --&gt;&#xd;
&#xd;
&lt;/if&gt;&#xd;
&lt;log message="~~~~~~~~~~~~~~~going to deactivate"/&gt;&#xd;
&lt;!-- deactivate --&gt;&#xd;
&lt;if&gt;&#xd;
	&lt;defined field-value="endDate"/&gt;&#xd;
	&lt;sequence&gt;&#xd;
	&lt;log message="~~~~~~~~~~~~~~~sleep before deactivate"/&gt;&#xd;
		&lt;sleep until="${f:endDate}"/&gt;&#xd;
		&lt;participant ref="command-deactivate"/&gt;&#xd;
	&lt;/sequence&gt;&#xd;
&lt;/if&gt;&#xd;
&#xd;
&lt;log level="debug" engine-log="yes" message="~~~~~~~~~~~~~~~flow end, start date is '${f:startDate}', end date is '${f:endDate}'"/&gt;&#xd;
&lt;/sequence&gt;&#xd;
&#xd;
&lt;/process-definition&gt;</sv:value>
  </sv:property>
  <sv:node sv:name="MetaData">
    <sv:property sv:name="jcr:primaryType" sv:type="Name">
      <sv:value>mgnl:metaData</sv:value>
    </sv:property>
    <sv:property sv:name="jcr:uuid" sv:type="String">
      <sv:value>fb5019dc-e3cd-40ae-9a2a-8a8abb8cd7ac</sv:value>
    </sv:property>
    <sv:property sv:name="mgnl:creationdate" sv:type="Date">
      <sv:value>2006-03-27T11:44:27.360+08:00</sv:value>
    </sv:property>
  </sv:node>
</sv:node>
