///This file contains parsers for htmlmixed, xml css, js, groovy and freemarker.
var tokenizeJavaScript=function(){function g(f,g,h,i){function p(b){var c=a(h,b);i(c?b:null);return{type:"string",style:"js-string"}}function o(){h.nextWhileMatches(c);return{type:"operator",style:"js-operator"}}function n(a){var b="/*",c=a=="*";while(!0){if(h.endOfLine())break;var d=h.next();if(d=="/"&&c){b=null;break}c=d=="*"}i(b);return{type:"comment",style:"js-comment"}}function m(){a(h,"/"),h.nextWhileMatches(/[gi]/);return{type:"regexp",style:"js-string"}}function l(){h.nextWhileMatches(e);var a=h.get(),c=b.hasOwnProperty(a)&&b.propertyIsEnumerable(a)&&b[a];return c?{type:c.type,style:c.style,content:a}:{type:"variable",style:"js-variable",content:a}}function k(){h.nextWhileMatches(/[0-9]/),h.equals(".")&&(h.next(),h.nextWhileMatches(/[0-9]/));if(h.equals("e")||h.equals("E"))h.next(),h.equals("-")&&h.next(),h.nextWhileMatches(/[0-9]/);return{type:"number",style:"js-atom"}}function j(){h.next(),h.nextWhileMatches(d);return{type:"number",style:"js-atom"}}if(f=='"'||f=="'")return p(f);var q=h.next();if(f=="/*")return n(q);if(q=='"'||q=="'")return p(q);if(/[\[\]{}\(\),;\:\.]/.test(q))return{type:q,style:"js-punctuation"};if(q=="0"&&(h.equals("x")||h.equals("X")))return j();if(/[0-9]/.test(q))return k();if(q=="/"){if(h.equals("*")){h.next();return n(q)}if(h.equals("/")){a(h,null);return{type:"comment",style:"js-comment"}}return g?m():o()}return c.test(q)?o():l()}function f(a,b){return function(c,d){var e=a,h=g(a,b,c,function(a){e=a}),i=h.type=="operator"||h.type=="keyword c"||h.type.match(/^[\[{}\(,;:]$/);(i!=b||e!=a)&&d(f(e,i));return h}}function a(a,b){var c=!1;while(!a.endOfLine()){var d=a.next();if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}var b=function(){function a(a,b){return{type:a,style:"js-"+b}}var b=a("keyword a","keyword"),c=a("keyword b","keyword"),d=a("keyword c","keyword"),e=a("operator","keyword"),f=a("atom","atom");return{"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"in":e,"typeof":e,"instanceof":e,"var":a("var","keyword"),"function":a("function","keyword"),"catch":a("catch","keyword"),"for":a("for","keyword"),"switch":a("switch","keyword"),"case":a("case","keyword"),"default":a("default","keyword"),"true":f,"false":f,"null":f,"undefined":f,NaN:f,Infinity:f}}(),c=/[+\-*&%=<>!?|]/,d=/[0-9A-Fa-f]/,e=/[\w\$_]/;return function(a,b){return tokenizer(a,b||f(!1,!0))}}(),JSParser=Editor.Parser=function(){function e(e,f){function T(a,b){a=="variable"&&(x(b),s())}function S(a,b){a=="variable"?(x(b),s(S)):a=="("&&s(v,K(T,")"),E,w)}function R(a){a==")"?t():s(F)}function Q(a,b){a==";"?s(R):b=="in"?s(F):s(F,B(";"),R)}function P(a,b){b=="in"?s(F):s(G,Q)}function O(a){a=="var"?s(M,Q):a==";"?t(Q):a=="variable"?s(P):t(Q)}function N(a,b){b=="="?s(F,N):a==","&&s(M)}function M(a,b){a=="variable"?(x(b),s(N)):s()}function L(a){a=="}"?s():t(E,L)}function K(a,b){function c(d){d==","?s(a,c):d==b?s():s(B(b))}return function d(d){d==b?s():t(a,c)}}function J(b){b=="variable"&&u("js-property"),a.hasOwnProperty(b)&&s(B(":"),F)}function I(a){a=="variable"&&(u("js-property"),s())}function H(a){a==":"?s(A,E):t(G,B(";"),A)}function G(a,b){a=="operator"&&/\+\+|--/.test(b)?s(G):a=="operator"?s(F):a==";"?t():a=="("?s(z(")"),K(F,")"),A,G):a=="."?s(I,G):a=="["&&s(z("]"),F,B("]"),A,G)}function F(b){a.hasOwnProperty(b)?s(G):b=="function"?s(S):b=="keyword c"?s(F):b=="("?s(z(")"),F,B(")"),A,G):b=="operator"?s(F):b=="["?s(z("]"),K(F,"]"),A,G):b=="{"?s(z("}"),K(J,"}"),A,G):s()}function E(a){a=="var"?s(z("vardef"),M,B(";"),A):a=="keyword a"?s(z("form"),F,E,A):a=="keyword b"?s(z("form"),E,A):a=="{"?s(z("}"),L,A):a==";"?s():a=="function"?s(S):a=="for"?s(z("form"),B("("),z(")"),O,B(")"),A,E,A):a=="variable"?s(z("stat"),H):a=="switch"?s(z("form"),F,z("}","switch"),B("{"),L,A,A):a=="case"?s(F,B(":")):a=="default"?s(B(":")):a=="catch"?s(z("form"),v,B("("),T,B(")"),E,A,w):t(z("stat"),F,B(";"),A)}function D(a){return t(F,D)}function C(a){return t(E,C)}function B(a){return function b(b){b==a?s():a==";"?t():s(arguments.callee)}}function A(){j.type==")"&&(l=j.indented),j=j.prev}function z(a,b){var d=function(){j=new c(l,k,a,null,j,b)};d.lex=!0;return d}function y(a){var b=i;while(b){if(b.vars[a])return!0;b=b.prev}return!1}function x(a){i&&(u("js-variabledef"),i.vars[a]=!0)}function w(){i=i.prev}function v(){i={prev:i,vars:{"this":!0,arguments:!0}}}function u(a){n=a}function t(){r(arguments),m=!1}function s(){r(arguments),m=!0}function r(a){for(var b=a.length-1;b>=0;b--)h.push(a[b])}function q(){var a=i,b=j,c=h.concat([]),d=g.state;return function e(e){i=a,j=b,h=c.concat([]),k=l=0,g=tokenizeJavaScript(e,d);return o}}function p(){while(h[h.length-1].lex)h.pop()();var a=g.next();a.type=="whitespace"&&k==0&&(l=a.value.length),k+=a.value.length,a.content=="\n"&&(l=k=0,"align"in j||(j.align=!1),a.indentation=d(j));if(a.type=="whitespace"||a.type=="comment")return a;"align"in j||(j.align=!0);while(!0){m=n=!1,h.pop()(a.type,a.content);if(m){n?a.style=n:a.type=="variable"&&y(a.content)&&(a.style="js-localvariable");return a}}}var g=tokenizeJavaScript(e),h=[b?D:C],i=null,j=new c((f||0)-indentUnit,0,"block",!1),k=0,l=0,m,n,o={next:p,copy:q};A.lex=!0;return o}function d(a){return function(b){var c=b&&b.charAt(0),d=a.type,e=c==d;return d=="vardef"?a.indented+4:d=="form"&&c=="{"?a.indented:d=="stat"||d=="form"?a.indented+indentUnit:a.info!="switch"||e?a.align?a.column-(e?1:0):a.indented+(e?0:indentUnit):a.indented+(/^(?:case|default)\b/.test(b)?indentUnit:2*indentUnit)}}function c(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,d!=null&&(this.align=d),this.prev=e,this.info=f}var a={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},b=!1;return{make:e,electricChars:"{}:",configure:function(a){a.json!=null&&(b=a.json)}}}(),XMLParser=Editor.Parser=function(){function f(a){function C(a){a=="xml-attribute"?n(C):o()}function B(a,b){b=="="?n(C):b==">"||b=="/>"?o(z):o()}function A(a){a=="xml-name"?(f.style="xml-attname",n(B,A)):o()}function z(a){return function(b,d){d=="/>"||d==">"&&c.autoSelfClosers.hasOwnProperty(j)?n():d==">"?(r(j,a),n()):(p(),n(arguments.callee))}}function y(a,b){a=="xml-name"&&(f.style="xml-tagname",k&&b.toLowerCase()==k.name?s():p()),n()}function x(a,b){a=="xml-name"?(j=b.toLowerCase(),f.style="xml-tagname",n()):(j=null,o())}function w(a,b){b=="<"?n(x,A,z(h==1)):b=="</"?n(y,q(">")):a=="xml-cdata"?((!k||k.name!="!cdata")&&r("!cdata"),/\]\]>$/.test(b)&&s(),n()):v.hasOwnProperty(a)?n():(p(),n())}function u(){return o(w,u)}function t(a){return function(b,c){var e=a;if(e&&e.noIndent)return c;if(d&&/<!\[CDATA\[/.test(b))return 0;e&&/^<\//.test(b)&&(e=e.prev);while(e&&!e.startOfLine)e=e.prev;return e?e.indent+indentUnit:0}}function s(){k=k.prev}function r(a,b){var d=c.doNotIndent.hasOwnProperty(a)||k&&k.noIndent;k={prev:k,name:a,indent:i,startOfLine:b,noIndent:d}}function q(a){return function(b,c){c==a?n():(p(),n(arguments.callee))}}function p(){f.style+=" xml-error"}function o(){m(arguments),l=!1}function n(){m(arguments),l=!0}function m(a){for(var b=a.length-1;b>=0;b--)g.push(a[b])}var b=e(a),f,g=[u],h=0,i=0,j=null,k=null,l,v={"xml-text":!0,"xml-entity":!0,"xml-comment":!0,"xml-processing":!0,"xml-doctype":!0};return{indentation:function(){return i},next:function(){f=b.next(),f.style=="whitespace"&&h==0?i=f.value.length:h++,f.content=="\n"&&(i=h=0,f.indentation=t(k));if(f.style=="whitespace"||f.type=="xml-comment")return f;while(!0){l=!1,g.pop()(f.style,f.content);if(l)return f}},copy:function(){var a=g.concat([]),c=b.state,d=k,f=this;return function(j){g=a.concat([]),h=i=0,k=d,b=e(j,c);return f}}}}var a={autoSelfClosers:{br:!0,img:!0,hr:!0,link:!0,input:!0,meta:!0,col:!0,frame:!0,base:!0,area:!0},doNotIndent:{pre:!0,"!cdata":!0}},b={autoSelfClosers:{},doNotIndent:{"!cdata":!0}},c=a,d=!1,e=function(){function d(b,c){return function(d,e){while(!d.endOfLine()){if(d.lookAhead(c,!0)){e(a);break}d.next()}return b}}function c(a){return function(c,d){while(!c.endOfLine())if(c.next()==a){d(b);break}return"xml-attribute"}}function b(b,d){var e=b.next();if(e==">"){d(a);return"xml-punctuation"}if(/[?\/]/.test(e)&&b.equals(">")){b.next(),d(a);return"xml-punctuation"}if(e=="=")return"xml-punctuation";if(/[\'\"]/.test(e)){d(c(e));return null}b.nextWhileMatches(/[^\s\u00a0=<>\"\'\/?]/);return"xml-name"}function a(a,c){var e=a.next();if(e=="<"){if(a.equals("!")){a.next();if(a.equals("[")){if(a.lookAhead("[CDATA[",!0)){c(d("xml-cdata","]]>"));return null}return"xml-text"}if(a.lookAhead("--",!0)){c(d("xml-comment","-->"));return null}if(a.lookAhead("DOCTYPE",!0)){a.nextWhileMatches(/[\w\._\-]/),c(d("xml-doctype",">"));return"xml-doctype"}return"xml-text"}if(a.equals("?")){a.next(),a.nextWhileMatches(/[\w\._\-]/),c(d("xml-processing","?>"));return"xml-processing"}a.equals("/")&&a.next(),c(b);return"xml-punctuation"}if(e=="&"){while(!a.endOfLine())if(a.next()==";")break;return"xml-entity"}a.nextWhileMatches(/[^&<\n]/);return"xml-text"}return function(b,c){return tokenizer(b,c||a)}}();return{make:f,electricChars:"/",configure:function(e){e.useHTMLKludges!=null&&(c=e.useHTMLKludges?a:b),e.alignCDATA&&(d=e.alignCDATA)}}}(),CSSParser=Editor.Parser=function(){function c(c,d){d=d||0;var e=a(c),f=!1,g=!1,h=!1,i={next:function(){var a=e.next(),c=a.style,i=a.content;c=="css-hash"&&(c=a.style=g?"css-colorcode":"css-identifier"),c=="css-identifier"&&(g?a.style="css-value":!f&&!h&&(a.style="css-selector")),i=="\n"&&(a.indentation=b(f,g,d)),i=="{"&&h=="@media"?h=!1:i=="{"?f=!0:i=="}"?f=g=h=!1:i==";"?g=h=!1:f&&c!="css-comment"&&c!="whitespace"?g=!0:!f&&c=="css-at"&&(h=i);return a},copy:function(){var b=f,c=g,d=e.state;return function(h){e=a(h,d),f=b,g=c;return i}}};return i}function b(a,b,c){return function(d){return!a||/^\}/.test(d)?c:b?c+indentUnit*2:c+indentUnit}}var a=function(){function d(b){return function(c,d){var e=!1;while(!c.endOfLine()){var f=c.next();if(f==b&&!e)break;e=!e&&f=="\\"}e||d(a);return"css-string"}}function c(b,c){var d=0;while(!b.endOfLine()){var e=b.next();if(d>=2&&e==">"){c(a);break}d=e=="-"?d+1:0}return"css-comment"}function b(b,c){var d=!1;while(!b.endOfLine()){var e=b.next();if(d&&e=="/"){c(a);break}d=e=="*"}return"css-comment"}function a(a,e){var f=a.next();if(f=="@"){a.nextWhileMatches(/\w/);return"css-at"}if(f=="/"&&a.equals("*")){e(b);return null}if(f=="<"&&a.equals("!")){e(c);return null}if(f=="=")return"css-compare";if(!a.equals("=")||f!="~"&&f!="|"){if(f=='"'||f=="'"){e(d(f));return null}if(f=="#"){a.nextWhileMatches(/\w/);return"css-hash"}if(f=="!"){a.nextWhileMatches(/[ \t]/),a.nextWhileMatches(/\w/);return"css-important"}if(/\d/.test(f)){a.nextWhileMatches(/[\w.%]/);return"css-unit"}if(/[,.+>*\/]/.test(f))return"css-select-op";if(/[;{}:\[\]]/.test(f))return"css-punctuation";a.nextWhileMatches(/[\w\\\-_]/);return"css-identifier"}a.next();return"css-compare"}return function(b,c){return tokenizer(b,c||a)}}();return{make:c,electricChars:"}"}}(),HTMLMixedParser=Editor.Parser=function(){function c(c){function j(){var a=d.copy(),b=e&&e.copy(),h=g.next,i=f;return function(j){c=j,d=a(j),e=b&&b(j),g.next=h,f=i;return g}}function i(a,b){var f=d.indentation();e=a.make(c,f+indentUnit);return function(){if(c.lookAhead(b,!1,!1,!0)){e=null,g.next=h;return h()}var a=e.next(),d=a.value.lastIndexOf("<"),i=Math.min(a.value.length-d,b.length);d!=-1&&a.value.slice(d,d+i).toLowerCase()==b.slice(0,i)&&c.lookAhead(b.slice(i),!1,!1,!0)&&(c.push(a.value.slice(d)),a.value=a.value.slice(0,d));if(a.indentation){var j=a.indentation;a.indentation=function(a){return a=="</"?f:j(a)}}return a}}function h(){var b=d.next();if(b.content=="<")f=!0;else if(b.style=="xml-tagname"&&f===!0)f=b.content.toLowerCase();else if(b.content==">"){if(a[f]){var c=window[a[f]];g.next=i(c,"</"+f)}f=!1}return b}b();var d=XMLParser.make(c),e=null,f=!1,g={next:h,copy:j};return g}function b(){var b=["XMLParser"];for(var c in a)b.push(a[c]);for(var d in b)if(!window[b[d]])throw new Error(b[d]+" parser must be loaded for HTML mixed mode to work.");XMLParser.configure({useHTMLKludges:!0})}var a={script:"JSParser",style:"CSSParser"};return{make:c,electricChars:"{}/:",configure:function(b){b.triggers&&(a=b.triggers)}}}(),tokenizeGroovy=function(){function m(a,b){for(var c in b){if(!b.hasOwnProperty(c))continue;if(a.hasOwnProperty(c))continue;a[c]=b[c]}return a}function l(j,k,l,m){function w(a){if(l.lookAhead(a,!0)){m(null);return{type:"string",style:"groovyString"}}var b=l.next();if(a=='"""'&&b=="$"&&!l.equals(" ")){l.next();return q()}return{type:"string",style:"groovyString"}}function v(a){var b=a;if(l.endOfLine())b=null;else{var c=l.next();if(a!="'"&&c=="$"&&!l.equals(" ")){l.next();return q()}c=="\\"&&l.equals(a)?(b="\\"+a,l.next()):c==a&&(b=null)}m(b);return{type:"string",style:"groovyString"}}function u(){x=="="?m("="):x=="~"?m("~"):m(null);return{type:"operator",style:"groovyOperator"}}function t(){l.nextWhileMatches(f);var a=l.get();return{type:"annotation",style:"javaAnnotation",content:a}}function s(a){var b="/*",c=a=="*";while(!0){if(l.endOfLine())break;var d=l.next();if(d=="/"&&c){b=null;break}c=d=="*"}m(b);return{type:"comment",style:"groovyComment"}}function r(){a(l,"/");return{type:"regexp",style:"groovyRegexp"}}function q(){l.nextWhileMatches(g);var a=l.get();return{type:"variable",style:"groovyVariable",content:a}}function p(){m(null),l.nextWhileMatches(f);var a=l.get(),c=b.hasOwnProperty(a)&&b.propertyIsEnumerable(a)&&b[a];return c?{type:c.type,style:c.style,content:a}:{type:"variable",style:"groovyVariable",content:a}}function o(){m(null),l.nextWhileMatches(d),l.equals(".")&&(l.next(),l.equals(".")&&l.next(),l.nextWhileMatches(d));if(l.equals("e")||l.equals("E"))l.next(),l.equals("-")&&l.next(),l.nextWhileMatches(d);return{type:"number",style:"groovyNumber"}}function n(){m(null),l.next(),l.nextWhileMatches(e);return{type:"number",style:"groovyNumber"}}if(j=='\\"'||j=="\\'"||j=="\\/"){m(j[1]);return{type:"string",style:"groovyString"}}if(i.test(j))return v(j);if(j=="'''"||j=='"""')return w(j);if(l.lookAhead(delimeter="'''",!0)||l.lookAhead(delimeter='"""',!0)){m(delimeter);return{type:"string",style:"groovyString"}}var x=l.next();if(j=="/*")return s(x);if(x=="'"||x=='"'){m(x);return{type:"string",style:"groovyString"}}if(x=="."&&l.equals(".")){l.next();return{type:"..",style:"groovyOperator"}}if(h.test(x))return{type:x,style:"groovyPunctuation"};if(x=="0"&&(l.equals("x")||l.equals("X")))return n();if(d.test(x))return o();if(x=="@")return t();if(x=="/"){if(l.equals("*")){l.next();return s(x)}if(l.equals("/")){a(l,null);return{type:"comment",style:"groovyComment"}}return j=="="||j=="~"?r():u()}if(x=="~"){m("~");return u(x)}return c.test(x)?u(x):p()}function k(a,b){return function(c,d){var e=a,f=l(a,b,c,function(a){e=a}),g=f.type=="operator"||f.type=="javaKeywordC"||f.type=="groovyKeywordC"||f.type.match(/^[\[{}\(,;:]$/);(g!=b||e!=a)&&d(k(e,g));return f}}function a(a,b){var c=!1,d;while(!a.endOfLine()){var d=a.next();if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}var b=function(){function a(a,b){return{type:a,style:b}}var b={},c={};c.javaKeywordA=["if","switch","while"],c.javaKeywordB=["else","do","try","finally"],c.javaKeywordC=["break","continue","extends","implements","import","new","package","return","super","this","throws"];for(var d in c)for(var e=0;e<c[d].length;e++)b[c[d][e]]=a(d,"javaKeyword");c={},c.javaAtom=["null","true","false"];for(var d in c)for(var e=0;e<c[d].length;e++)b[c[d][e]]=a(d,d);c={},c.javaModifier=["abstract","final","native","private","protected","public","static","strictfp","synchronized","threadsafe","transient","volatile"],c.javaType=["boolean","byte","char","enum","double","float","int","interface","long","short","void","class"];for(var d in c)for(var e=0;e<c[d].length;e++)b[c[d][e]]=a("function",d);b=m(b,{"catch":a("catch","javaKeyword"),"for":a("for","javaKeyword"),"case":a("case","javaKeyword"),"default":a("default","javaKeyword"),"instanceof":a("operator","javaKeyword")});var c={};c.groovyGsdkMethod=["abs","any","append","asList","asWritable","collect","compareTo","count","div","dump","each","eachByte","eachFile","eachLine","every","find","findAll","getAt","getErr","getIn","getOut","getText","grep","inject","inspect","intersect","isCase","join","leftShift","minus","multiply","mixin","newInputStream","newOutputStream","newPrintWriter","newReader","newWriter","next","plus","pop","power","previous","print","println","push","putAt","readBytes","readLines","reverse","reverseEach","round","size","sort","splitEachLine","step","subMap","times","toInteger","toList","tokenize","upto","waitForOrKill","withPrintWriter","withReader","withStream","withWriterAppend","write","writeLine"];for(var e=0;e<c.groovyGsdkMethod.length;e++)b[c.groovyGsdkMethod[e]]=a("groovyGsdkMethod","groovyGsdkMethod");c.groovyKeywordC=["assert","property"];for(var e=0;e<c.groovyKeywordC.length;e++)b[c.groovyKeywordC[e]]=a("groovyKeywordC","groovyKeyword");b=m(b,{as:a("operator","groovyKeyword"),"in":a("operator","groovyKeyword"),def:a("function","groovyKeyword")});return b}(),c=/[+\-*&%\/=<>!?|]/,d=/[0-9]/,e=/^[0-9A-Fa-f]$/,f=/[\w\$_]/,g=/[\w\.()\[\]{}]/,h=/[\[\]{}\(\),;\:\.]/,i=/^[\/'"]$/,j=/^[\/'$]/;return function(a,b){return tokenizer(a,b||k(!1,!0))}}(),GroovyParser=Editor.Parser=function(){function c(c){c=tokenizeGroovy(c);var d=0,e=null,f=!1,g=0,h={next:function(){var h=c.next();if(h.type=="whitespace")if(h.value=="\n")if(e!==null){e.type==="{"?(f=!0,d+=indentUnit,g++):e.type==="}"&&(f=!1,g>0?g--:g=0);var i=new a(d,h,f,e,g);h.indentation=b(i)}else h.indentation=function(a,b){};else d=h.value.length;e=h;return h},copy:function(){var a=d;return function(b){d=indented=a,c=tokenizeGroovy(b);return h}}};return h}function b(a){return function(b,c,d){if(a.encloseLevel!==0&&b==="}")return a.startColumn-indentUnit;return a.startColumn}}function a(a,b,c,d,e){this.startColumn=a,this.currentToken=b,c!=null&&(this.align=c),this.previousToken=d,this.encloseLevel=e}return{make:c,electricChars:"}"}}(),FreemarkerParser=Editor.Parser=function(){function c(c){function g(a,b){var c=a.length;while(c--)if(a[c]===b)return!0;return!1}function f(a){return function(){return a}}var d=b(c),e=0,h={next:function(){var b=d.next();b.type=="whitespace"&&(b.value=="\n"?b.indentation=f(e):e=b.value.length),b.type=="freemarker-identifier"&&(g(a,b.value.replace(/^\s+|\s+$/g,""))&&(b.style="freemarker-directive",b.type="freemarker-directive"));return b},copy:function(){var a=d.state,c=e;return function(f){e=c,d=b(f,a);return h}}};return h}var a=["if","elseif","else","list","foreach","switch","case","assign","global","local","include","import","function","macro","transform","visit","stop","return","call","setting","compress","comment","noparse","attempt","recover"],b=function(){function f(b,c){return function(d,e){while(!d.endOfLine()){if(d.lookAhead(c,!0)){e(a);break}d.next()}return b}}function e(a,b){return function(c,d){while(!c.endOfLine())if(c.next()==a){d(b);break}return"freemarker-string"}}function d(a){return function(b,c){var d=b.peek();if(/[a-zA-Z_]/.test(d)){b.next(),b.nextWhileMatches(/[a-zA-Z_0-9]+/),c(a);return"freemarker-builtin"}c(a)}}function c(b){return function(f,g){var h=f.next();if(h==b){g(a);return"freemarker-boundary"}if(/[?\/]/.test(h)&&f.equals(b)){f.next(),g(a);return"freemarker-boundary"}if(/[?!]/.test(h)){h=="?"&&(f.peek()=="?"?f.next():g(d(c(b))));return"freemarker-punctuation"}if(/[()+\/\-*%]/.test(h))return"freemarker-punctuation";if(/[0-9]/.test(h)){f.nextWhileMatches(/[0-9]+\.?[0-9]* /);return"freemarker-number"}if(/\w/.test(h)){f.nextWhileMatches(/\w/);return"freemarker-identifier"}if(/[\'\"]/.test(h)){g(e(h,c(b)));return"freemarker-string"}f.nextWhileMatches(/[^\s\u00a0<>\"\'\}?!\/]/);return"freemarker-generic"}}function b(b,d){var e=b.next();if(e=="{"){d(c("}"));return"freemarker-boundary"}b.nextWhileMatches(/\w/),d(a);return"freemarker-identifier"}function a(a,d){var e=a.next();if(e=="<"){if(a.equals("!")){a.next();if(a.lookAhead("--",!0)){d(f("freemarker-comment","-->"));return null}return"freemarker-text"}a.nextWhileMatches(/[\#\@\/]/),d(c(">"));return"freemarker-boundary"}if(e=="["){a.nextWhileMatches(/[\#\@\/]/),d(c("]"));return"freemarker-boundary"}if(e=="$"){if(a.matches(/[\{\w]/)){d(b);return"freemarker-boundary"}return"freemarker-text"}a.nextWhileMatches(/[^\$<\n]/);return"freemarker-text"}return function(b,c){return tokenizer(b,c||a)}}();return{make:c}}()