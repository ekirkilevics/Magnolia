<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>
      ${this.messages.get("central.title")}
    </title>
    <link rel="shortcut icon" href="${this.request.contextPath}/.resources/admin-images/favicon.ico"
      type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="${this.request.contextPath}/.resources/admin-css/admin-all.css" />
    <!--  keep the old javascripts -->
    <script type="text/javascript" src="${this.request.contextPath}/.magnolia/pages/javascript.js"><!-- --></script>
    <script type="text/javascript" src="${this.request.contextPath}/.magnolia/pages/messages.${this.user.language}.js"><!-- --></script>
    <script type="text/javascript">
        importClass("mgnl.admininterface.AdminCentral");
        importClass("mgnl.admininterface.Navigation");

        var mgnlNavigation;
        var mgnlAdminCentral;

        function configureNavigation() {
            ${this.navigation.javascript}
        }

        // init the system
        onload = function() {
            // start the admin central
            mgnlAdminCentral = new MgnlAdminCentral();

            // create and configure the navigation
            mgnlNavigation = new MgnlNavigation();
            configureNavigation();

            // init navigation
            mgnlNavigation.create('mgnlAdminCentralMenuInnerDiv');

            // call the onload method
            try {
                if (opener &&  opener.MgnlAdminCentral && opener.MgnlAdminCentral.onOpenedInNewWindow) {
                    opener.MgnlAdminCentral.onOpenedInNewWindow(mgnlAdminCentral);
                }
                else {
                    // call the frist menupoint with a link
                    mgnlNavigation.activate('${this.navigation.firstId}', true);
                }
            } catch(e) {
                // Permission denied to get property Window.MgnlAdminCentral
                mgnlNavigation.activate('${this.navigation.firstId}', true);
            }


            // resize
            mgnlAdminCentral.resize();

            [#if this.message?exists]
                mgnlAdminCentral.setMessage("${this.message?js_string}","${this.messageCSSClass}");
            [/#if]

            // on resize
            onresize = function() {
                mgnlAdminCentral.resize()
            };
        }
    </script>
  </head>
  <body id="mgnl" class="mgnlBgDark mgnlAdminMain">
    <!-- logo -->
    <div>
    <a href="http://www.magnolia-cms.com" target="_blank">
      <img style="position:absolute; top:17px; left:20px" alt="Magnolia - Simple Open Source Content Management"
        src="${this.request.contextPath}/.resources/admin-images/magnoliaLogo.gif" />
    </a>
    </div>
    <!--  user info -->
    [#if this.user?exists]
    <div style="position:absolute;top:34px;right:20px;text-align:right;" class="mgnlText">
      <form action="" method="post" style="padding: 0; margin: 0;">
        <div>
        <input type="hidden" name="mgnlLogout" value="true"/>
        ${this.messages.get("central.user")}: <span onclick="mgnlOpenDialog('${this.user.userNode.@handle}','','','','users','.magnolia/dialogs/userpreferences.html')" style=" font-size: 11px; color: black; border: 0; background: transparent; outline: invert none 0; cursor: pointer; padding: 0; margin: 0;" onmouseover="this.style.textDecoration = 'underline';" onmouseout="this.style.textDecoration = 'none';">${this.user.name}</span> |
        <input type="submit" name="logout" value="${this.messages.get('central.logout')?html}" style="font-size: 11px; border: 0; background: transparent; outline: invert none 0; cursor: pointer; padding: 0; margin: 0:" onmouseover="this.style.textDecoration = 'underline';" onmouseout="this.style.textDecoration = 'none';"/>
        </div>
      </form>
    </div>
    [/#if]
    <!-- Menu -->
    <div id="mgnlAdminCentralMenuDiv" class="mgnlAdminCentralMenuDiv">
      <div id="mgnlAdminCentralMenuInnerDiv" style="position: absolute;">
        <!-- do not delete me -->
      </div>
      <div id="mgnlAdminCentralMessageBoxDiv">
        <!-- do not delete me -->
      </div>
    </div>

    <!-- Not scrolled content like the website tree -->
    <div id="mgnlAdminCentralContentDiv" class="mgnlAdminCentralContentDiv">
      <iframe id="mgnlAdminCentralContentIFrame" src="" scrolling="no" style="border: none; width:100%; height:100%"
        frameborder="0">
      </iframe>
    </div>
    <!-- Scrolled content like the about or other included pages -->
    <div id="mgnlAdminCentralScrolledContentDiv" class="mgnlAdminCentralContentDiv">
      <iframe id="mgnlAdminCentralScrolledContentIFrame" src="" style="border: none; width:100%; height:100%"
        frameborder="0">
      </iframe>
    </div>
    <!-- About -->
    <div id="mgnlAdminCentralFooterDiv" style="position:absolute;text-align:center;" class="mgnlText">
      <a href="http://www.magnolia-cms.com" target="_blank">Magnolia</a>
      &trade; Simple Open Source Content Management. ${this.versionString} -
      <a href="http://jira.magnolia-cms.com" target="_blank">${this.messages.get("central.bugFeatureRequest")}</a> -
      <a href="http://documentation.magnolia-cms.com" target="_blank">${this.messages.get("central.documentation")}</a>
    </div>
  </body>
</html>
